digraph G {
  rankdir = "RL";
  node [shape = rect, fontname = "sans-serif"];
  "data.archive_file.code" [label="data.archive_file.code"];
  "data.aws_iam_policy_document.assume_role" [label="data.aws_iam_policy_document.assume_role"];
  "aws_apigatewayv2_api.leadgen" [label="aws_apigatewayv2_api.leadgen"];
  "aws_apigatewayv2_integration.lambda_integration" [label="aws_apigatewayv2_integration.lambda_integration"];
  "aws_apigatewayv2_route.leadgen" [label="aws_apigatewayv2_route.leadgen"];
  "aws_apigatewayv2_stage.prod" [label="aws_apigatewayv2_stage.prod"];
  "aws_db_instance.postgres" [label="aws_db_instance.postgres"];
  "aws_db_subnet_group.db_subnet" [label="aws_db_subnet_group.db_subnet"];
  "aws_iam_instance_profile.ec2_airflow_profile" [label="aws_iam_instance_profile.ec2_airflow_profile"];
  "aws_iam_role.ec2_airflow_role" [label="aws_iam_role.ec2_airflow_role"];
  "aws_iam_role.lambda" [label="aws_iam_role.lambda"];
  "aws_iam_role.rds_s3_export_role" [label="aws_iam_role.rds_s3_export_role"];
  "aws_iam_role_policy.ec2_airflow_policy" [label="aws_iam_role_policy.ec2_airflow_policy"];
  "aws_iam_role_policy.lambda_vpc_policy" [label="aws_iam_role_policy.lambda_vpc_policy"];
  "aws_iam_role_policy.rds_s3_export_policy" [label="aws_iam_role_policy.rds_s3_export_policy"];
  "aws_instance.snap" [label="aws_instance.snap"];
  "aws_internet_gateway.igw" [label="aws_internet_gateway.igw"];
  "aws_kms_key.s3_export_key" [label="aws_kms_key.s3_export_key"];
  "aws_lambda_function.leadgen" [label="aws_lambda_function.leadgen"];
  "aws_lambda_permission.allow_http_api" [label="aws_lambda_permission.allow_http_api"];
  "aws_route_table.public_rt" [label="aws_route_table.public_rt"];
  "aws_route_table_association.public_assoc" [label="aws_route_table_association.public_assoc"];
  "aws_s3_bucket.rds_snapshots" [label="aws_s3_bucket.rds_snapshots"];
  "aws_security_group.ec2" [label="aws_security_group.ec2"];
  "aws_security_group.lambda" [label="aws_security_group.lambda"];
  "aws_security_group.rds" [label="aws_security_group.rds"];
  "aws_subnet.bastion" [label="aws_subnet.bastion"];
  "aws_subnet.main" [label="aws_subnet.main"];
  "aws_subnet.main2" [label="aws_subnet.main2"];
  "aws_vpc.main" [label="aws_vpc.main"];
  "aws_vpc_security_group_ingress_rule.ec2_to_rds" [label="aws_vpc_security_group_ingress_rule.ec2_to_rds"];
  "aws_vpc_security_group_ingress_rule.lambda_to_rds" [label="aws_vpc_security_group_ingress_rule.lambda_to_rds"];
  "aws_vpc_security_group_ingress_rule.public_to_ec2" [label="aws_vpc_security_group_ingress_rule.public_to_ec2"];
  "aws_apigatewayv2_integration.lambda_integration" -> "aws_apigatewayv2_api.leadgen";
  "aws_apigatewayv2_integration.lambda_integration" -> "aws_lambda_function.leadgen";
  "aws_apigatewayv2_route.leadgen" -> "aws_apigatewayv2_integration.lambda_integration";
  "aws_apigatewayv2_stage.prod" -> "aws_apigatewayv2_api.leadgen";
  "aws_db_instance.postgres" -> "aws_db_subnet_group.db_subnet";
  "aws_db_instance.postgres" -> "aws_security_group.rds";
  "aws_db_subnet_group.db_subnet" -> "aws_subnet.main";
  "aws_db_subnet_group.db_subnet" -> "aws_subnet.main2";
  "aws_iam_instance_profile.ec2_airflow_profile" -> "aws_iam_role.ec2_airflow_role";
  "aws_iam_role.lambda" -> "data.aws_iam_policy_document.assume_role";
  "aws_iam_role_policy.ec2_airflow_policy" -> "aws_iam_role.ec2_airflow_role";
  "aws_iam_role_policy.ec2_airflow_policy" -> "aws_kms_key.s3_export_key";
  "aws_iam_role_policy.ec2_airflow_policy" -> "aws_s3_bucket.rds_snapshots";
  "aws_iam_role_policy.lambda_vpc_policy" -> "aws_iam_role.lambda";
  "aws_iam_role_policy.rds_s3_export_policy" -> "aws_iam_role.rds_s3_export_role";
  "aws_iam_role_policy.rds_s3_export_policy" -> "aws_kms_key.s3_export_key";
  "aws_iam_role_policy.rds_s3_export_policy" -> "aws_s3_bucket.rds_snapshots";
  "aws_instance.snap" -> "aws_iam_instance_profile.ec2_airflow_profile";
  "aws_instance.snap" -> "aws_security_group.ec2";
  "aws_instance.snap" -> "aws_subnet.bastion";
  "aws_internet_gateway.igw" -> "aws_vpc.main";
  "aws_lambda_function.leadgen" -> "data.archive_file.code";
  "aws_lambda_function.leadgen" -> "aws_db_instance.postgres";
  "aws_lambda_function.leadgen" -> "aws_iam_role.lambda";
  "aws_lambda_function.leadgen" -> "aws_security_group.lambda";
  "aws_lambda_permission.allow_http_api" -> "aws_apigatewayv2_api.leadgen";
  "aws_lambda_permission.allow_http_api" -> "aws_lambda_function.leadgen";
  "aws_route_table.public_rt" -> "aws_internet_gateway.igw";
  "aws_route_table_association.public_assoc" -> "aws_route_table.public_rt";
  "aws_route_table_association.public_assoc" -> "aws_subnet.bastion";
  "aws_security_group.ec2" -> "aws_vpc.main";
  "aws_security_group.lambda" -> "aws_vpc.main";
  "aws_security_group.rds" -> "aws_vpc.main";
  "aws_subnet.bastion" -> "aws_vpc.main";
  "aws_subnet.main" -> "aws_vpc.main";
  "aws_subnet.main2" -> "aws_vpc.main";
  "aws_vpc_security_group_ingress_rule.ec2_to_rds" -> "aws_security_group.ec2";
  "aws_vpc_security_group_ingress_rule.ec2_to_rds" -> "aws_security_group.rds";
  "aws_vpc_security_group_ingress_rule.lambda_to_rds" -> "aws_security_group.lambda";
  "aws_vpc_security_group_ingress_rule.lambda_to_rds" -> "aws_security_group.rds";
  "aws_vpc_security_group_ingress_rule.public_to_ec2" -> "aws_security_group.ec2";
}